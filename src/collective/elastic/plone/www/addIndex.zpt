<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <meta http-equiv="content-type" content="text/html;charset=utf8" />
    <title tal:content="context/title_or_id"></title>
    <link rel="stylesheet" type="text/css" href="manage_page_style.css" />
    <style>
      #editdiv {
        width: 800px;
        height: 400px;
      }
    </style>
</head>

<p><a href="${python:context.absolute_url()}/manage_catalogIndexes">Abort and back</a></p>


<form action="manage_addESPIndex" method="post" enctype="multipart/form-data">
<table cellspacing="0" cellpadding="2" border="0">
  <tr>
    <td align="left" valign="top">
      <div class="form-optional">
      Add Index of Type
      </div>
    </td>
    <td align="left" valign="top">
      ElasticSearchProxyIndex
    </td>
  </tr>

  <tr>
    <td align="left" valign="top">
      <div class="form-label">
        Id
      </div>
      </td>
    <td align="left" valign="top">
      <input type="text" name="id" size="40" />
    </td>
  </tr>

  <tr>
    <td align="left" valign="top">
      <div class="form-label">
        ElasticSearch JSON-Query Template
      </div>
    </td>
    <td align="left" valign="top">
      <textarea id="editvalue"
                name="extra.query_template:record"
                rows="40"
                cols="120">{}</textarea>
      <div id="editdiv" />
    </td>
  </tr>

  <tr>
    <td align="left" valign="top">
    </td>
    <td align="left" valign="top">
    <div class="form-element">
    <input class="form-element" type="submit" name="submit"
     value=" Add " />
    </div>
    </td>
  </tr>
</table>
</form>

<script src="${context/portal_url}/++plone++static/components/ace-builds/src/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editdiv = document.querySelector('#editdiv');
    var editor = ace.edit(editdiv)

    editor.session.setMode("ace/mode/json");
    editor.setTheme("ace/theme/monokai");
    var textarea = document.querySelector('#editvalue');
    textarea.style.display = 'none';
    editor.getSession().setValue(textarea.value);
    editor.getSession().on('change', function(){
      textarea.value = editor.getSession().getValue();
    });
</script>

<h1 tal:replace="structure context/manage_page_footer">FOOTER</h1>
