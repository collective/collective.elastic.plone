<?xml version="1.0"?>
<object name="portal_catalog" meta_type="Plone Catalog Tool">
  <index name="SearchableText" meta_type="ZCTextIndex" remove="true"></index>
  <index name="SearchableText" meta_type="ElasticSearchProxyIndex">
    <querytemplate>
{
    "query":{
        "bool":{
            "should":[
                    {
                        "query_string":{
                            "query":"{{keys[0].decode('utf8')}}",
                            "fields":[
                                "title^1.2",
                                "id",
                                "description^1.1",
                                "subjects^2"
                                ]
                        }
                    },
                    {
                        "nested":{
                            "path":"text__extracted",
                            "query":{
                                "query_string":{
                                    "query":"{{keys[0].decode('utf8')}}",
                                    "fields":["text__extracted.content"]
                                }
                            }
                        }
                    },
                    {
                        "nested":{
                            "path":"file__extracted",
                            "query":{
                                "query_string":{
                                    "query":"{{keys[0].decode('utf8')}}",
                                    "fields":["file__extracted.content"]
                                }
                            }
                        }
                    },
                    {
                        "nested":{
                            "path":"image__extracted",
                            "query":{
                                "query_string":{
                                    "query":"{{keys[0].decode('utf8')}}",
                                    "fields":["image__extracted.content"]
                            }
                        }
                    }
                }
            ]
        }
    }
}
    </querytemplate>
  </index>
</object>